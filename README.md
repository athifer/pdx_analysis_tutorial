# PDX Analysis Tutorial

This repository provides a comprehensive tutorial for analyzing Patient-Derived Xenograft (PDX) data, including tumor growth, gene expression, and variant data. The package demonstrates typical workflows for preclinical oncology data analysis using R and Python, with example scripts and mock datasets.

## üìö Learning Objectives

By completing this tutorial, you will learn to:
- Analyze tumor growth kinetics using linear mixed-effects models
- Perform differential gene expression analysis on PDX RNA-seq data
- Integrate genomic variants with treatment response data
- Create publication-quality visualizations for PDX studies
- Apply statistical methods for biomarker discovery in preclinical models

## üîß Prerequisites

### Software Requirements
- **R** (‚â• 4.0.0) with packages: `DRAP`, `lme4`, `ggplot2`, `DESeq2`, `pheatmap`
- **Python** (‚â• 3.8) with packages: `pandas`, `numpy`, `matplotlib`, `seaborn`, `scipy`
- **Git** for version control
- **Jupyter** for interactive analysis

### Knowledge Requirements
- Basic understanding of R and Python programming
- Familiarity with statistical concepts (linear models, hypothesis testing)
- Basic knowledge of cancer biology and preclinical research
- Understanding of genomics data types (RNA-seq, variants)

### Estimated Time
- **Beginner**: 4-6 hours
- **Intermediate**: 2-3 hours
- **Advanced**: 1-2 hours

## üöÄ Quick Start Tutorial

### Step 1: Environment Setup (5 minutes)
```bash
# Clone the repository
git clone https://github.com/athifer/pdx_analysis_tutorial.git
cd pdx_analysis_tutorial

# Install Python dependencies
pip install -r requirements.txt

# Install R dependencies (run in R console)
# install.packages(c("lme4", "ggplot2", "pheatmap", "BiocManager"))
# BiocManager::install("DESeq2")
# devtools::install_github('SCBIT-YYLab/DRAP')
```

### Step 2: Data Exploration (10 minutes)
```python
# Run data exploration notebook
jupyter notebook notebooks/01_data_exploration.ipynb
```

### Step 3: Tumor Growth Analysis (15 minutes)
```r
# Analyze tumor volume data
Rscript src/R/analyze_volume.R
```

### Step 4: Gene Expression Analysis (20 minutes)
```python
# Run biomarker analysis
jupyter notebook notebooks/02_biomarker_analysis.ipynb
```

### Step 5: Variant Analysis (15 minutes)
```python
# Analyze genomic variants
python src/python/variant_analysis.py
```

### Step 6: Integrated Analysis (10 minutes)
```python
# Combine all data types
jupyter notebook notebooks/03_integrated_analysis.ipynb
```

## Repository Structure

- **data/**: Contains mock datasets for demonstration purposes.
	- `expression_tpm_mock.csv`: Simulated gene expression (TPM) matrix for PDX models.
	- `tumor_volumes_mock.csv`: Simulated tumor volume measurements over time for different PDX models and treatment arms.
	- `variants_mock.csv`: Simulated variant calls (mutation data) for PDX models.
- **results/**: Example output figures generated by the analysis scripts.
	- `heatmap_top40.png`: Heatmap of the top 40 variable genes (example output).
	- `mean_growth_curves.png`: Mean tumor growth curves by treatment arm (example output).
	- `spider_plot.png`: Spider plot summarizing response metrics (example output).
- **scripts/**: Analysis scripts and notebooks.
	- `analyze_volume.R`: R script for analyzing tumor volume data using linear mixed models and the DRAP package.
	- `preprocessing.py`: Python helpers for loading and normalizing tumor volume data.
	- `download_real_data.sh`: Example shell script for downloading real PDX annotation data from public repositories.
	- `biomarker_analysis.ipynb`: (Empty) Jupyter notebook for biomarker analysis (template for further work).

## Getting Started

1. Clone the repository and install required R and Python packages as needed (see comments in scripts).
2. Use the mock data in `data/` to test the analysis scripts.
3. Run the scripts in `scripts/` to reproduce example results in `results/`.

## üõ†Ô∏è Troubleshooting

### Common Issues

**Issue**: `Error: package 'DRAP' not found`
**Solution**: Install DRAP from GitHub: `devtools::install_github('SCBIT-YYLab/DRAP')`

**Issue**: `ModuleNotFoundError: No module named 'pandas'`
**Solution**: Install Python dependencies: `pip install -r requirements.txt`

**Issue**: Memory error during analysis
**Solution**: Reduce dataset size or increase system memory allocation

**Issue**: Plots not displaying correctly
**Solution**: Check graphics device settings and ensure proper package installation

### Getting Help
- Check the [documentation](docs/) for detailed explanations
- Review the [FAQ](docs/FAQ.md) for common questions
- Open an [issue](https://github.com/athifer/pdx_analysis_tutorial/issues) for bugs or questions

## üìñ References

### PDX Research Background
- **Hidalgo et al. (2014)** - Patient-derived xenograft models: an emerging platform for translational cancer research. *Cancer Discovery*
- **Gao et al. (2015)** - High-throughput screening using patient-derived tumor xenografts to predict clinical trial drug response. *Nature Medicine*

### Statistical Methods
- **Bates et al. (2015)** - Fitting Linear Mixed-Effects Models Using lme4. *Journal of Statistical Software*
- **Love et al. (2014)** - Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2. *Genome Biology*

### PDX Databases
- [PDX Finder](https://www.pdxfinder.org/) - Comprehensive PDX model database
- [PDMR](https://pdmr.cancer.gov/) - Patient-Derived Models Repository
- [EurOPDX](https://www.europdx.eu/) - European PDX consortium

## Notes
- The provided data are mock examples for tutorial purposes only.
- For real data, see the instructions in `download_real_data.sh` and update file paths as needed.
- The `biomarker_analysis.ipynb` notebook is a template for further biomarker discovery analyses.

## License
See `LICENSE` for details.
